import streamlit as st
import pandas as pd
import numpy as np

st.set_page_config(page_title="Contamio Dashboard", layout="wide")

# Sidebar
st.sidebar.title("Contamio")
st.sidebar.markdown(" 住 转  爪专  砖转")

# Main Title
st.title("    住 转  - Contamio")
st.markdown("""
砖  注专转 Contamio - 驻转专 住住    转 砖转 砖 住 转 .
""")

# Simulate layered risk data
def generate_sample_data():
    np.random.seed(42)
    plants = ["驻注 ", "驻注 ", "驻注 "]
    risks = ["住专", "住", "E.Coli", "砖专 转"]
    data = []
    for plant in plants:
        for risk in risks:
            global_risk = np.random.rand()
            interplant_risk = np.random.rand()
            internal_risk = np.random.rand()
            weight = np.random.rand()
            final_score = round((global_risk * 0.3 + interplant_risk * 0.3 + internal_risk * 0.4) * weight, 2)
            data.append({
                "驻注": plant,
                "住": risk,
                "": global_risk,
                "-驻注": interplant_risk,
                "驻": internal_risk,
                "砖拽 ": weight,
                "爪 住驻": final_score
            })
    return pd.DataFrame(data)

# Load data
df = generate_sample_data()

# Filter
def show_filters():
    plant_filter = st.sidebar.selectbox("专 驻注", options=[""] + list(df["驻注"].unique()))
    if plant_filter != "":
        return df[df["驻注"] == plant_filter]
    return df

filtered_df = show_filters()

# Display table
st.subheader(" 转 住")
st.dataframe(filtered_df.style.background_gradient(cmap="OrRd"), use_container_width=True)

# Charts
st.subheader(" 砖转 住  住")
risk_summary = filtered_df.groupby("住")["爪 住驻"].mean().sort_values(ascending=False)
st.bar_chart(risk_summary)

st.markdown("---")
st.caption("漏 2025 Contamio - All rights reserved")

